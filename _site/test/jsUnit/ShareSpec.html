<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <script src="../../static/lib/jquery-2.0.3.js"></script>
    <script src="../vendor/mocha.js"></script>
    <script src="../vendor/require.js"></script>
    <script src="config.js" ></script>

</head>
<body>
<!--PLACEHOLDER FOR MOCHA TEST RESULTS-->
<div id="mocha"></div>

<!--FIXTURE HTML FOR TESTS-->
<div id="spec-markup">

    <div class="share-popup clearfix">
        <a class="summary" href="#!" data-tracking-context="Cyprus Bailout: Savings Shift Amid Russia Offer" aria-label="Shared 146 times. Click to show share options">
            <i class="skycon-share"></i>
            <span class="share-word" aria-hidden="true">Share</span>
            <span class="share-count" aria-hidden="true">146</span>
        </a>
        <ul class="popover">
            <li class="tweet-button clearfix">
                <a class='tweet-link hover-colour' data-popup="{'width': '550','height':'420','title':'twitter-share-dialog'}" data-tracking-context='Cyprus Bailout: Savings Shift Amid Russia Offer' href='https://twitter.com/intent/tweet?url=http%3A%2F%2Fnews.sky.com%2Fstory%2F1066004%2Fcyprus-bailout-savings-shift-amid-russia-offer&text=Cyprus Bailout: Savings Shift Amid Russia Offer' target='_blank'><i aria-hidden=true class='skycon-twitter'></i><span class='speak display-name'>Twitter</span></a><span class='share-count'>137</span>
            </li>
            <li class="facebook-button clearfix">
                <a class='fb-link hover-colour' data-popup="{'width': '626','height':'436','title':'facebook-share-dialog'}" data-tracking-context='Cyprus Bailout: Savings Shift Amid Russia Offer' href='https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fapps.facebook.com%2Fskynewsfb%2Farticle.php%3Fid%3D1066004'><i aria-hidden=true class='skycon-facebook'></i><span class='speak display-name'>Facebook</span></a><span class='share-count'>5</span>
            </li>
            <li class="gplus-button clearfix">
                <a class='gplus-link hover-colour' data-popup="{'width': '550','height':'420','title':'gplus-share-dialog'}" data-tracking-context='Cyprus Bailout: Savings Shift Amid Russia Offer' href='https://plus.google.com/share?url=http%3A%2F%2Fnews.sky.com%2Fstory%2F1066004%2Fcyprus-bailout-savings-shift-amid-russia-offer'><i aria-hidden=true class='skycon-google-plus'></i><span class='speak display-name'>Google+</span></a><span class='share-count'>4</span>
            </li>
            <li class="email-button clearfix">
                <a class='email-link hover-colour' data-tracking-context='Cyprus Bailout: Savings Shift Amid Russia Offer' href='mailto:?subject=Sharing - Cyprus Bailout: Savings Shift Amid Russia Offer&body=http%3A%2F%2Fnews.sky.com%2Fstory%2F1066004%2Fcyprus-bailout-savings-shift-amid-russia-offer'><i aria-hidden=true class='skycon-mail'></i><span class='speak display-name'>Mail</span></a>
            </li>
        </ul>
    </div>

</div>

</div>
<!--TEST-->
<script>

    require(['components/share', '../../test/jsUnit/setup'],function(share){

        describe('Share module with click', function() {

            it('clicking share link should open the popup', function() {
                expect($('.share-popup.active').length).to.equal(0);
                $('.summary').click();
                expect($('.share-popup.active').length).to.equal(1);
                $('.summary').click();
                expect($('.share-popup.active').length).to.equal(0);
            });

            it(' Pressing enter on share link should open popup', function() {
                expect($('.share-popup.active').length).to.equal(0);
                var e = jQuery.Event("keypress");
                e.which = 13; // # Some key code value
                $(".summary").trigger(e);
                expect($('.share-popup.active').length).to.equal(1);
                $(".summary").trigger(e);
                expect($('.share-popup.active').length).to.equal(0);
            });

            it('Pressing any key should not open share popup', function() {
                expect($('.share-popup.active').length).to.equal(0);
                var e = jQuery.Event("keypress");
                e.which = 12; // # Some key code value
                $(".summary").trigger(e);
                expect($('.share-popup.active').length).to.equal(0);
            });
        });
        mocha.run();
    });
</script>

</body>
</html>